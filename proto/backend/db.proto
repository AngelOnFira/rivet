syntax = "proto3";

package rivet.backend.db;

import "proto/common.proto";
import "google/protobuf/empty.proto";

// MARK: Game Namespace Config
message GameNamespaceConfig {
}

// MARK: Game Version Config
message GameVersionConfig {	
	/*
	message Database {
		string key = 1;
		rivet.common.Uuid database_id = 2;
	}

	repeated Database databases = 1;
	*/
}

// MARK: Game Version Config Context
message GameVersionConfigCtx {

}

// MARK: Game Version Config Meta
message GameVersionConfigMeta {
	
}

// Database
message Database {
	rivet.common.Uuid database_id = 1;
	rivet.common.Uuid owner_team_id = 2;
	string name_id = 3;
	Schema schema = 4;
}

message Schema {
	repeated Collection collections = 1;
}

message Collection {
	string name_id = 1;
	repeated Field fields = 2;
}

message Field {
	enum Type {
		INT = 0;
		FLOAT = 1;
		BOOL = 2;
		STRING = 3;
	}

	string name_id = 1;
	Type type = 2;
	bool optional = 3;
}

// Query
message Query {
	message Get {
		string collection = 1;
		string id = 2;
		repeated string fields = 3;
	}

	message Set {
		string collection = 1;
		string id = 2;
		map<string, Value> fields = 3;
		repeated string returning_fields = 4;
	}

	oneof kind {
		Get get = 101;
		Set set = 102;
	}
}

message Value {
	oneof type {
		google.protobuf.Empty null = 1;
		int64 int = 2;
		double float = 3;
		bool bool = 4;
		string string = 5;
	}
}

