# yaml-language-server: $schema=https://raw.githubusercontent.com/fern-api/fern/main/fern.schema.json

imports:
  commons: ../common.yml
  localCommons: common.yml

service:
  auth: true
  url: Database
  base-path: /collections/{collection}
  audiences:
    - public
  path-parameters:
    collection:
      type: string
  endpoints:
    fetch:
      path: /fetch
      method: POST
      request:
        body: FetchRequest
      response: FetchResponse

    insert:
      path: /insert
      method: POST
      request:
        body: InsertRequest
      response: InsertResponse

    update:
      path: /update
      method: POST
      request:
        body: UpdateRequest
      response: UpdateResponse

    delete:
      path: /delete
      method: POST
      request:
        body: DeleteRequest
      response: DeleteResponse

types:
  FetchRequest:
    properties:
      database_id: optional<uuid>
      filters: optional<list<localCommons.Filter>>

  FetchResponse:
    properties:
      entries: list<localCommons.Entry>

  InsertRequest:
    properties:
      database_id: optional<uuid>
      entry: map<string, unknown>

  InsertResponse:
    properties:
      ids: list<string>

  UpdateRequest:
    properties:
      database_id: optional<uuid>
      filters: optional<list<localCommons.Filter>>
      set: optional<map<string, unknown>>

  UpdateResponse:
    properties:
      updated_count: integer

  DeleteRequest:
    properties:
      database_id: optional<uuid>
      filters: optional<list<localCommons.Filter>>

  DeleteResponse:
    properties:
      deleted_count: integer

